package br.com.loteria.main;

import java.io.BufferedInputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.util.logging.Logger;

public class TesteDownload {

	  public static void main(String[] args) {  
	        if (downloadArquivoExcel()) {  
	            System.out.println("Download concluído com sucesso");  
	        } else {  
	            System.out.println("Download não concluído");  
	        }  
	    }  
	  
	    private static boolean downloadArquivoExcel() {  
	        InputStream is = null;  
	        BufferedInputStream buf = null;  
	        FileOutputStream out = null;  
	        boolean ok = false;  
	        try {  
	            URL url = new URL("http://www1.caixa.gov.br/loterias/_arquivos/loterias/D_lotfac.zip");  
	            url.getHost();  
	            url.getFile();  
	            url.getPort();  
	            url.getUserInfo();  
	            URLConnection con = url.openConnection();  
	            buf = new BufferedInputStream(con.getInputStream());  
	            out = new FileOutputStream("c:\\excelDown.xls");  
	  
	            int i = 0;  
	            byte[] bytesIn = new byte[1024];  
	            while ((i = buf.read(bytesIn)) >= 0) {  
	                out.write(bytesIn, 0, i);  
	            }  
	            ok = true;  
	        } catch (MalformedURLException ex) {  
	            Logger.getLogger(TesteDownloadArqExcel.class.getName()).log(Level.SEVERE, null, ex);  
	        } catch (IOException ioe) {  
	            Logger.getLogger(TesteDownloadArqExcel.class.getName()).log(Level.SEVERE, null, ioe);  
	        } finally {  
	            try {  
	                if (buf != null) {  
	                    buf.close();  
	                }  
	                if (out != null) {  
	                    out.close();  
	                }  
	            } catch (IOException ex) {  
	                Logger.getLogger(TesteDownloadArqExcel.class.getName()).log(Level.SEVERE, null, ex);  
	            }  
	        }  
	        if (ok) {  
	            return ok;  
	        }  
	        return false;  
	    }  

 

}
